# Kafka/Redpanda connection settings
bootstrap.servers=redpanda:9092
application.id=schema-attacher

# Kafka Streams configuration
default.key.serde=org.apache.kafka.common.serialization.Serdes$StringSerde
default.value.serde=org.apache.kafka.common.serialization.Serdes$StringSerde

# Processing guarantees - exactly-once semantics
processing.guarantee=exactly_once_v2

# --- Example Topic Configuration ---
# Pattern: schema.topic.<input-topic>=<schema-json>
#          output.topic.<input-topic>=<output-topic>

# Topic 1: users - Processed user data with transformations
# - Names are uppercase normalized
# - Only users with emails (filtered)
# Note: account_age_days removed (mz_now() not supported in materialized views)
schema.topic.users-json-noschema={"type": "struct", "fields": [{"type": "int64", "optional": false, "field": "id"}, {"type": "string", "optional": false, "field": "name"}, {"type": "string", "optional": false, "field": "email"}, {"type": "int64", "optional": false, "field": "created_at"}, {"type": "int64", "optional": false, "field": "created_timestamp", "name": "org.apache.kafka.connect.data.Timestamp", "version": 1}], "optional": false, "name": "materialize.users"}
output.topic.users-json-noschema=users-json-withschema

# Topic 2: orders - Processed orders with categorization
# - Includes order_size computed by Materialize (small/medium/large)
# - Amounts rounded to 2 decimals
# - Cancelled orders filtered out
schema.topic.orders-json-noschema={"type": "struct", "fields": [{"type": "int64", "optional": false, "field": "order_id"}, {"type": "int64", "optional": false, "field": "user_id"}, {"type": "double", "optional": false, "field": "amount"}, {"type": "string", "optional": false, "field": "status"}, {"type": "int64", "optional": false, "field": "order_time"}, {"type": "string", "optional": false, "field": "order_size"}], "optional": false, "name": "materialize.orders"}
output.topic.orders-json-noschema=orders-json-withschema

# Topic 3: events - Filtered and categorized events
# - Includes event_category computed by Materialize (user_action/system_event)
# - Only important event types included
schema.topic.events-json-noschema={"type": "struct", "fields": [{"type": "int64", "optional": false, "field": "event_id"}, {"type": "string", "optional": false, "field": "event_type"}, {"type": "string", "optional": true, "field": "user_id"}, {"type": "string", "optional": true, "field": "metadata"}, {"type": "int64", "optional": false, "field": "timestamp"}, {"type": "string", "optional": false, "field": "event_category"}], "optional": false, "name": "materialize.events"}
output.topic.events-json-noschema=events-json-withschema
